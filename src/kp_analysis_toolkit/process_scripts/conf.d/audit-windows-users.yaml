global:
  sys_filter:
    - attr: os_family
      comp: eq
      value: Windows

03_users_01_local_admin_user:
  regex: 'Users_LocalAdministrator::((Name[ ]+:[ ]+(?P<name>[\w ]+))|(Enabled[ ]+:[ ]+(?P<enabled>[\w ]+))|(LastLogon[ ]+:[ ]+(?P<lastLogon>[\w ]+))|(PasswordLastSet[ ]+:[ ]+(?P<passwordLastSet>[\w ]+))|(PasswordRequired[ ]+:[ ]+(?P<passwordReqd>[\w ]+))|(PasswordExpires[ ]+:[ ]+(?P<passwordExpires>[\w /-:]+)))'
  excel_sheet_name: Local Administrator User
  comment: |-
    Details about the local Administrator account.
  keywords: ['users', 'local users', 'authentication']
  field_list:
    - name
    - enabled
    - lastLogon
    - passwordLastSet
    - passwordReqd
    - passwordExpires
  only_matching: True
  multiline: True
03_users_02_local_admin_group:
  regex: 'Users_LocalGroupAdministrators::(?!Members)(?!--)(?!The command completed successfully)\w'
  excel_sheet_name: Local Administrator Group
  comment: |-
    Details about the local Administrator account.
  keywords: ['users', 'local users', 'local groups', 'authentication']
03_users_03_local_password_policy:
  regex: 'Users_LocalPasswordPolicy::((Minimum password age \(days\):[ ]+)(?P<minAge>\d+)|(Maximum password age \(days\):[ ]+)(?P<maxAge>\d+)|(Minimum password length:[ ]+)(?P<minLength>\d+)|(Length of password history maintained:[ ]+)(?P<history>[\w\d]+)|(Lockout threshold:[ ]+)(?P<lockoutThreshold>[\w\d]+)|(Lockout duration \(minutes\):[ ]+)(?P<lockoutDuration>\d+)|(Lockout observation window \(minutes\):[ ]+)(?P<lockoutWindow>\d+))'
  excel_sheet_name: Local Password Policy
  comment: |-
    The local computer's password policy.  This may not be the same as the domain policy.  For the domain policy, you'll need to have your customer run the KPADAudit.ps1 script.
  keywords: ['users', 'password policy', 'authentication']
  only_matching: True
  field_list:
    - minAge
    - maxAge
    - minLength
    - history
    - lockoutThreshold
    - lockoutDuration
    - lockoutWindow
  multiline: True
  full_scan: True
03_users_04_local_users:
  regex: 'Users_LocalUsers::(?!Name)((?P<userName>[\w .$-]+?)(?P<enabled>(True|False))[ ]+(?P<lastLogon>([\d/-]+ [\d:]+ (AM|PM)?)|[ ]{3}).*?(?P<userMayChangePassword>(True|False))[ ]+(?P<passwordExpires>([\d/-]+ [\d:]+ (AM|PM)?)|[ ]{3})[ ]*(?P<passwordLastSet>([\d/-]+ [\d:]+ (AM|PM)?)|[ ]{3})[ ]*(?P<sid>S-[\d-]+))'
  excel_sheet_name: Local Users
  comment: |-
    The local computer's local user list.  All fields should be self-explanatory.
  keywords: ['users', 'local users', 'authentication']
  field_list:
    - userName
    - enabled
    - lastLogon
    - userMayChangePassword
    - passwordExpires
    - passwordLastSet
    - sid
  full_scan: True
  only_matching: True
03_users_05_local_groups:
  regex: 'Users_LocalGroups::(((?P<groupName>[\w $.-]+))( (?P<sid>S[-\d]+))[ ]+(?P<groupDesc>[\w ]+))'
  excel_sheet_name: Local Groups
  comment: |-
    A list of all of the localgroups on the system.  Everything should be self-explanatory, but the SID can be used to verify, among other things, any unique SIDs you find in local_users.
  keywords: ['users', 'local groups', 'authentication']
  field_list:
    - groupName
    - sid
    - groupDesc
  only_matching: True
