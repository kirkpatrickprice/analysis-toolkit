Document batching strategies for large dataset processing